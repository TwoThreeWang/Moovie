{{ $douban := .DoubanID }}
{{ $title := .Title }}
{{ $poster := .Poster }}
{{ $year := .Year }}
<div class="movie-actions" id="actions-{{ $douban }}">
    <!-- 1. 想看 (Wish) 按钮：始终排在第一位 -->
    {{ if .IsWish }}
    <button
        class="btn btn-secondary btn-current"
        hx-delete="/api/user-movies/{{ $douban }}?title={{ $title }}&poster={{ $poster }}&year={{ $year }}"
        hx-confirm="确定取消“想看”吗？"
        hx-target="#actions-{{ $douban }}"
        hx-swap="outerHTML"
    >
        <span class="icon">
            <!-- 选中的实心心形图标 -->
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 6 4 4 6.5 4c1.74 0 3.41 1 4.22 2.5C11.09 5 12.76 4 14.5 4 17 4 19 6 19 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
            </svg>
        </span> 已想看
    </button>
    {{ else }}
    <button
        class="btn btn-secondary"
        hx-post="/api/user-movies/{{ $douban }}/wish?title={{ $title }}&poster={{ $poster }}&year={{ $year }}"
        hx-target="#actions-{{ $douban }}"
        hx-swap="outerHTML"
    >
        <span class="icon">
            <!-- 默认的空心心形图标 -->
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-.98-1.06a5.5 5.5 0 0 0-7.78 7.78l.98.98L12 21.35l7.78-7.98.98-.98a5.5 5.5 0 0 0 0-7.78z"/>
            </svg>
        </span> 想看
    </button>
    {{ end }}

    <!-- 2. 看过 (Watched) 按钮：始终排在第二位 -->
    {{ if .IsWatched }}
    <button
        class="btn btn-secondary btn-current"
        hx-delete="/api/user-movies/{{ $douban }}?title={{ $title }}&poster={{ $poster }}&year={{ $year }}"
        hx-confirm="确定取消“已看过”吗？"
        hx-target="#actions-{{ $douban }}"
        hx-swap="outerHTML"
    >
        <span class="icon">
            <!-- 选中的实心打勾图标 -->
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
            </svg>
        </span> 已看过
    </button>
    {{ else }}
    <button
        class="btn btn-secondary"
        hx-get="/api/htmx/user-movie/mark-watched?douban_id={{ $douban }}&title={{ $title }}&poster={{ $poster }}&year={{ $year }}"
        hx-target="body"
        hx-swap="beforeend"
    >
        <span class="icon">
            <!-- 默认的空心打勾图标 -->
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
        </span> 看过
    </button>
    {{ end }}
</div>
