
{{ define "content" }}
<div class="player-page">
    <div class="player-container" id="player-container">
        <!-- æ’­æ”¾å™¨ç”± JavaScript åˆå§‹åŒ– -->
        <div class="player-loading">åŠ è½½ä¸­...</div>
    </div>

    <div class="player-controls">
        {{ if .Sources }}
        <div class="source-tabs">
            <h4>çº¿è·¯é€‰æ‹©</h4>
            {{ range $i, $source := .Sources }}
            <button class="source-tab {{ if eq $i 0 }}active{{ end }}" data-source="{{ $source.Name }}">
                {{ $source.Name }}
            </button>
            {{ end }}
        </div>

        <div class="episode-list">
            <h4>é€‰é›†</h4>
            <div class="episodes">
                {{ range .Episodes }}
                <a href="/play/{{ $.DoubanID }}?source={{ $.Source }}&ep={{ .Title }}"
                   class="episode {{ if eq .Title $.Episode }}active{{ end }}">
                    {{ .Title }}
                </a>
                {{ end }}
            </div>
        </div>
        {{ end }}

        <div class="player-actions">
            <button class="btn btn-secondary"
                    hx-post="/api/feedback"
                    hx-vals='{"type":"error","content":"æ’­æ”¾å¤±è´¥","movie_url":"{{.PlayURL}}"}'
                    hx-swap="outerHTML">
                ğŸš« æ’­æ”¾å¤±è´¥åé¦ˆ
            </button>
        </div>
    </div>
</div>

<script>
    // è®°å½•è§‚å½±å†å²
    document.addEventListener('DOMContentLoaded', function() {
        if (typeof recordWatch === 'function') {
            recordWatch({
                doubanId: '{{ .DoubanID }}',
                title: '{{ .Title }}',
                poster: '{{ .Poster }}',
                episode: '{{ .Episode }}',
                source: '{{ .Source }}'
            });
        }
    });
</script>
{{ end }}
